/**

* Please Wait
* Display a nice loading screen while your app loads

* @author Pathgather <tech@pathgather.com>
* @copyright Pathgather 2014
* @license MIT <http://opensource.org/licenses/mit-license.php>
* @link https://github.com/Pathgather/please-wait
* @module pleaseWait
* @version 0.0.1
*/
!function(a,b){"object"==typeof exports?b(exports):"function"==typeof define&&define.amd?define(["exports"],b):b(a)}(this,function(a){var b;return b=function(){var a,b;return a=function(){var a,b,c,d;a=document.createElement("fakeelement"),c={WebkitAnimation:"webkitAnimationEnd",OAnimation:"oAnimationEnd",msAnimation:"MSAnimationEnd",MozAnimation:"mozAnimationEnd",animation:"animationend"};for(b in c)if(d=c[b],null!=a.style[b])return d},b={defaultOptions:{backgroundColor:{required:!1},logo:{required:function(a){return null==a&&(a={}),null==a.template}},spinnerTemplate:{required:function(a){return null==a&&(a={}),null==a.template}},template:{"default":"<h1 class='pg-loading-logo-header'>\n  <img class='pg-loading-logo'></img>\n</h1>\n<div class='pg-loading-spinner'>\n</div>"}},done:function(){var b,c;if(null!=this._loadingDiv)return c=a(),b=function(a){return function(){return document.body.removeChild(a._loadingDiv),document.body.className+=" pg-loaded",null!=c&&a._loadingDiv.removeEventListener(c,b),a._loadingDiv=null}}(this),null!=c?(this._loadingDiv.className+=" pg-loaded",this._loadingDiv.addEventListener(c,b)):b()},load:function(a){var b,c,d;return null==a&&(a={}),this._options=this._createOptions(a),this._loadingDiv=document.createElement("header"),this._loadingDiv.className="pg-loading-screen",null!=this._options.backgroundColor&&(this._loadingDiv.style.backgroundColor=this._options.backgroundColor),this._loadingDiv.innerHTML=this._options.template,null==a.template&&(d=null,c=this._loadingDiv.getElementsByClassName("pg-loading-spinner")[0],c.innerHTML=this._options.spinnerTemplate,b=this._loadingDiv.getElementsByClassName("pg-loading-logo")[0],b.src=this._options.logo),document.body.appendChild(this._loadingDiv),this._loadingDiv.className+=" pg-loading",this._loadingDiv},_createOptions:function(a){var b,c,d,e,f,g;null==a&&(a={}),b=this.defaultOptions,d={};for(c in b){if(g=b[c],e=null!=a[c],null!=g.required&&(f="function"==typeof g.required?g.required(a):g.required,f&&!e))throw new Error("Option '"+c+"' is required");d[c]=e?a[c]:g["default"]}return d}},{start:function(a){return null==a&&(a={}),b.load(a)},finish:function(){return b.done()}}},a.pleaseWait=new b}),function(a,b){"object"==typeof exports?b(exports):"function"==typeof define&&define.amd?define(["exports"],b):b(a)}(this,function(a){var b;return b=function(){var a,b;return a=function(){var a,b,c,d;a=document.createElement("fakeelement"),c={WebkitAnimation:"webkitAnimationEnd",OAnimation:"oAnimationEnd",msAnimation:"MSAnimationEnd",MozAnimation:"mozAnimationEnd",animation:"animationend"};for(b in c)if(d=c[b],null!=a.style[b])return d},b={defaultOptions:{backgroundColor:{required:!1},logo:{required:function(a){return null==a&&(a={}),null==a.template}},spinnerTemplate:{required:function(a){return null==a&&(a={}),null==a.template}},template:{"default":"<h1 class='pg-loading-logo-header'>\n  <img class='pg-loading-logo'></img>\n</h1>\n<div class='pg-loading-spinner'>\n</div>"}},done:function(){var b,c;if(null!=this._loadingDiv)return c=a(),b=function(a){return function(){return document.body.removeChild(a._loadingDiv),document.body.className+=" pg-loaded",null!=c&&a._loadingDiv.removeEventListener(c,b),a._loadingDiv=null}}(this),null!=c?(this._loadingDiv.className+=" pg-loaded",this._loadingDiv.addEventListener(c,b)):b()},load:function(a){var b,c,d;return null==a&&(a={}),this._options=this._createOptions(a),this._loadingDiv=document.createElement("header"),this._loadingDiv.className="pg-loading-screen",null!=this._options.backgroundColor&&(this._loadingDiv.style.backgroundColor=this._options.backgroundColor),this._loadingDiv.innerHTML=this._options.template,null==a.template&&(d=null,c=this._loadingDiv.getElementsByClassName("pg-loading-spinner")[0],c.innerHTML=this._options.spinnerTemplate,b=this._loadingDiv.getElementsByClassName("pg-loading-logo")[0],b.src=this._options.logo),document.body.appendChild(this._loadingDiv),this._loadingDiv.className+=" pg-loading",this._loadingDiv},_createOptions:function(a){var b,c,d,e,f,g;null==a&&(a={}),b=this.defaultOptions,d={};for(c in b){if(g=b[c],e=null!=a[c],null!=g.required&&(f="function"==typeof g.required?g.required(a):g.required,f&&!e))throw new Error("Option '"+c+"' is required");d[c]=e?a[c]:g["default"]}return d}},{start:function(a){return null==a&&(a={}),b.load(a)},finish:function(){return b.done()}}},a.pleaseWait=new b}),function(){"use strict";describe("PleaseWait",function(){var a;return a=function(){var a,b,c,d;a=document.createElement("fakeelement"),c={WebkitAnimation:"webkitAnimationEnd",OAnimation:"oAnimationEnd",msAnimation:"MSAnimationEnd",MozAnimation:"mozAnimationEnd",animation:"animationend"};for(b in c)if(d=c[b],null!=a.style[b])return d},it("defines start & finish",function(){return expect(pleaseWait.start).toBeDefined(),expect(pleaseWait.finish).toBeDefined()}),describe("start",function(){var a;return a=null,beforeEach(function(){return null==a?a=document.body.innerHTML:void 0}),afterEach(function(){return document.body.innerHTML=a}),describe("when using the default template",function(){return it("requires a logo",function(){return expect(function(){return pleaseWait.start({logo:null,spinnerTemplate:"<div></div>"})}).toThrowError("Option 'logo' is required")}),it("requires a spinner template",function(){return expect(function(){return pleaseWait.start({logo:"logo.png",spinnerTemplate:null})}).toThrowError("Option 'spinnerTemplate' is required")}),it("adds the template to the body",function(){var a,b;return b=pleaseWait.start({logo:"logo.png",spinnerTemplate:"<div></div>"}),a=document.body.getElementsByClassName("pg-loading-screen")[0],expect(b).toEqual(a),expect(a.nodeName).toEqual("HEADER"),expect(b.children[0].nodeName).toEqual("H1")})}),describe("when using a custom template",function(){return it("does not require a logo",function(){return expect(function(){return pleaseWait.start({logo:null,template:"<div></div>"})}).not.toThrow()}),it("does not require a spinner template",function(){return expect(function(){return pleaseWait.start({spinnerTemplate:null,template:"<div></div>"})}).not.toThrow()}),it("adds the template to the body",function(){var a,b;return b=pleaseWait.start({logo:null,template:"<div></div>"}),a=document.body.getElementsByClassName("pg-loading-screen")[0],expect(b).toEqual(a),expect(a.nodeName).toEqual("HEADER"),expect(b.children[0].nodeName).toEqual("DIV")})}),describe("when specifying a background color",function(){return it("sets the loading screen's background color",function(){var a;return a=pleaseWait.start({logo:"logo.png",spinnerTemplate:"<div></div>",backgroundColor:"#CCCCCC"}),expect(a.style.backgroundColor).toEqual("rgb(204, 204, 204)")})})}),describe("finish",function(){return it("removes the loading screen from the body after it transitions out",function(){var b,c;return b=pleaseWait.start({logo:"logo.png",spinnerTemplate:"<div></div>"}),b=document.body.getElementsByClassName("pg-loading-screen")[0],expect(b).toBeDefined(),pleaseWait.finish(),c=document.createEvent("Event"),c.initEvent(a(),!0,!0),b.dispatchEvent(c),b=document.body.getElementsByClassName("pg-loading-screen")[0],expect(b).not.toBeDefined()})})})}.call(this);